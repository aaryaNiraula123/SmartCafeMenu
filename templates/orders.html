<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Orders</title>
    />
  </head>
  <body>
    <header>
      <h2>Orders</h2>
      <a href="{{ url_for('admin_panel') }}">Admin Panel</a>
    </header>

    <main>
      <table id="orders-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Table</th>
            <th>Items</th>
            <th>Status</th>
            <th>Time</th>
          </tr>
        </thead>
        <tbody id="orders-body"></tbody>
      </table>
    </main>

    <script>
      async function loadOrders() {
        const res = await fetch("/api/orders");
        const data = await res.json();
        const tbody = document.getElementById("orders-body");
        tbody.innerHTML = "";
        data.forEach((o) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${o.id}</td><td>${o.user_name}</td><td>${
            o.table_number
          }</td>
          <td>${o.items
            .map((i) => i.name + " x" + i.quantity)
            .join("<br>")}</td>
          <td>${o.status}</td><td>${o.created_at}</td>`;
          tbody.appendChild(tr);
        });
      }
      loadOrders();
    </script>
  </body>
</html>
